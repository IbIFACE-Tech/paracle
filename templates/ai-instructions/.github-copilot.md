# GitHub Copilot Guide for Paracle .parac Configuration

## Introduction

This guide helps GitHub Copilot understand and work with Paracle's `.parac/` configuration system for multi-agent AI applications.

## What is .parac?

The `.parac/` directory contains all project configuration, agent definitions, workflows, policies, and runtime settings for a Paracle project.

## Directory Structure

```
.parac/
├── project.yaml              # Main project configuration
├── agents/
│   ├── manifest.yaml        # Agent registry
│   └── specs/*.yaml         # Individual agent specifications
├── workflows/
│   ├── catalog.yaml         # Workflow registry
│   └── templates/*.yaml     # Workflow definitions
├── tools/
│   └── registry.yaml        # Tool registry and permissions
├── policies/
│   ├── policy-pack.yaml     # Active policies
│   └── security.yaml        # Security policies
├── memory/
│   ├── index.yaml           # Memory index
│   └── knowledge/*.md       # Knowledge base
├── adapters/
│   └── orchestrators.yaml   # External integrations
└── logs/                     # Runtime logs (auto-generated)
```

## Key Configuration Files

### project.yaml

The main project configuration file.

**Required Fields:**
```yaml
name: project-name           # Project identifier (lowercase-with-hyphens)
version: 0.1.0              # Semantic version
description: "..."          # Brief description
schema_version: "1.0"       # Schema version (required)
```

**Common Sections:**
```yaml
defaults:
  python_version: "3.10"
  model_provider: openai     # openai, anthropic, google, local
  default_model: gpt-4
  temperature: 0.7

features:
  enable_mcp: true           # Model Context Protocol
  enable_api: true           # REST API
  enable_events: true        # Event bus
  enable_tracing: false      # OpenTelemetry

logging:
  level: INFO
  format: json
  retention_days: 30
```

### Agent Configuration

**Manifest (agents/manifest.yaml):**
```yaml
schema_version: "1.0"
agents:
  - name: assistant
    description: "AI assistant"
    spec_file: specs/assistant.yaml
    enabled: true
    version: 1.0.0
    tags: [general, helper]
```

**Specification (agents/specs/assistant.yaml):**
```yaml
name: assistant
description: "Helpful AI assistant"
version: 1.0.0

provider: openai
model: gpt-4
temperature: 0.7
max_tokens: 2000

system_prompt: |
  You are a helpful AI assistant.
  Be concise and accurate.

# Assign skills to agent
skills:
  - question-answering
  - text-summarization
  - code-generation

tools: []
memory:
  enabled: true
```

### Agent Skills

Paracle supports **two skill formats**:

#### 1. YAML Format (Lightweight)

Best for simple capability declarations:

```yaml
# .parac/agents/skills/custom/my-skill.yaml
name: my-skill
display_name: "My Custom Skill"
category: creation              # communication, analysis, creation, transformation, integration, memory
level: intermediate             # basic, intermediate, advanced, expert
description: |
  What this skill does and when to use it.

# Required tools
tools:
  - file_system
  - code_executor

# Specific capabilities
capabilities:
  - capability1
  - capability2

# Prerequisites
requirements:
  - skill_name: question-answering
    min_level: basic

# Metadata
tags:
  - tag1
  - tag2
version: "1.0.0"
enabled: true
```

#### 2. Agent Skills Format (SKILL.md)

Best for detailed instructions with code examples:

```markdown
# .parac/agents/skills/custom/pdf-processing/SKILL.md
---
name: pdf-processing
description: Extract text and tables from PDF files, fill forms, merge documents. Use when working with PDF documents.
license: Apache-2.0
compatibility: Requires pypdf2, pdfplumber
metadata:
  author: your-team
  version: "1.0.0"
  category: transformation
  level: intermediate
  display_name: "PDF Processing"
  tags:
    - pdf
    - document
  capabilities:
    - text_extraction
    - form_filling
allowed-tools: Read Write Bash(pypdf2:*)
---

# PDF Processing Skill

## When to use this skill
- Extract text from PDFs
- Fill PDF forms
- Merge multiple PDFs

## How to extract text
\```python
import pdfplumber

def extract_text(pdf_path):
    with pdfplumber.open(pdf_path) as pdf:
        return ''.join(page.extract_text() for page in pdf.pages)
\```

## Best practices
- Validate PDF files first
- Handle errors gracefully
```

**Skill Categories:**
- **Communication**: Q&A, conversation, summarization
- **Analysis**: Data analysis, pattern recognition
- **Creation**: Code/content generation
- **Transformation**: Data processing, formatting
- **Integration**: API calls, tool usage
- **Memory**: Context management, recall

**Skill Levels:**
- **Basic** (0-25%): Fundamental, needs guidance
- **Intermediate** (25-50%): Competent, some autonomy
- **Advanced** (50-75%): Proficient, high autonomy
- **Expert** (75-100%): Mastery level

**Built-in Skills:**
- `question-answering` (Communication, Intermediate)
- `code-generation` (Creation, Advanced)
- `data-analysis` (Analysis, Advanced)
- `text-summarization` (Transformation, Intermediate)
- `api-integration` (Integration, Advanced)

**Specification (agents/specs/assistant.yaml):**
```yaml
name: assistant
description: "Helpful AI assistant"
version: 1.0.0

provider: openai
model: gpt-4
temperature: 0.7
max_tokens: 2000

system_prompt: |
  You are a helpful assistant.
  Provide clear, concise answers.

capabilities:
  - question_answering
  - task_assistance

tools: []
memory:
  enabled: true
  type: conversation
```

### Workflow Configuration

**Catalog (workflows/catalog.yaml):**
```yaml
schema_version: "1.0"
workflows:
  - name: hello-world
    description: "Simple greeting workflow"
    template: templates/hello_world.yaml
    enabled: true
    version: 1.0.0
```

**Definition (workflows/templates/hello_world.yaml):**
```yaml
name: hello-world
description: "Generate friendly greeting"
version: 1.0.0

inputs:
  - name: user_name
    type: string
    required: false
    default: "World"

steps:
  - name: greet
    agent: assistant
    prompt: "Greet {user_name} warmly"
    output: greeting

outputs:
  - name: result
    value: "{greeting}"
```

## Code Completion Patterns

### Creating a New Agent

When suggesting agent creation:

```yaml
# agents/specs/code-reviewer.yaml
name: code-reviewer
description: "Reviews code for quality and best practices"
version: 1.0.0

provider: openai
model: gpt-4
temperature: 0.3              # Lower for deterministic analysis

system_prompt: |
  You are an expert code reviewer.

  Review code for:
  - Correctness and bugs
  - Performance issues
  - Security vulnerabilities
  - Code style and readability

  Provide specific, actionable feedback.

capabilities:
  - code_review
  - bug_detection
  - security_analysis

tools:
  - name: file_system
    enabled: true
    permissions: [read]
```

### Creating a Workflow

When suggesting workflow creation:

```yaml
# workflows/templates/data-pipeline.yaml
name: data-pipeline
description: "Process data through multiple stages"
version: 1.0.0

inputs:
  - name: data_source
    type: string
    required: true
  - name: output_format
    type: string
    default: json

steps:
  - name: extract
    agent: data-extractor
    prompt: "Extract data from {data_source}"
    output: raw_data

  - name: transform
    agent: data-transformer
    prompt: "Transform {raw_data} into structured format"
    output: processed_data

  - name: format
    agent: data-formatter
    prompt: "Format {processed_data} as {output_format}"
    output: final_data

outputs:
  - name: result
    value: "{final_data}"
```

## Best Practices for Suggestions

### 1. Naming Conventions

```yaml
# ✅ Good
name: code-reviewer           # Descriptive, hyphenated
name: data-processor
name: content-generator

# ❌ Avoid
name: agent1                  # Not descriptive
name: MyAgent                 # Not lowercase
name: codeReviewer            # Not hyphenated
```

### 2. Temperature Selection

```yaml
# Deterministic tasks (code, data analysis)
temperature: 0.0-0.3

# Balanced tasks (general assistance)
temperature: 0.5-0.7

# Creative tasks (content generation)
temperature: 0.8-1.0
```

### 3. Model Selection

```yaml
# Complex reasoning, important decisions
model: gpt-4

# Simple, high-volume tasks
model: gpt-3.5-turbo

# Long context requirements
model: claude-3-opus-20240229
```

### 4. Security Configuration

Always suggest secure defaults:

```yaml
# tools/registry.yaml
builtin_tools:
  - name: file_system
    enabled: false           # ✅ Disabled by default
    permissions: [read]      # ✅ Minimal permissions
    allowed_paths: [/tmp]    # ✅ Restricted paths

# policies/security.yaml
content_filtering:
  enabled: true             # ✅ Always enabled
  filter_pii: true          # ✅ Protect privacy
  filter_harmful: true      # ✅ Safety first

rate_limiting:
  enabled: true             # ✅ Prevent abuse
  requests_per_minute: 60
```

## Common Tasks

### Initialize Project Configuration

```bash
# Copy template
cp -r templates/.parac-template .parac

# Edit configuration
code .parac/project.yaml

# Set up environment
cp .parac/.env.example .env
```

### Add New Agent

```bash
# 1. Create specification
cat > .parac/agents/specs/my-agent.yaml << EOF
name: my-agent
provider: openai
model: gpt-4
...
EOF

# 2. Register in manifest
# Edit .parac/agents/manifest.yaml and add:
agents:
  - name: my-agent
    spec_file: specs/my-agent.yaml
    enabled: true
```

### Enable a Feature

```yaml
# Edit .parac/project.yaml
features:
  enable_api: true           # Enable REST API
  enable_tracing: true       # Enable tracing
```

## Validation Rules

When suggesting changes, ensure:

1. **Schema Version**: Present in all YAML files
   ```yaml
   schema_version: "1.0"
   ```

2. **Required Fields**: All required fields populated
   ```yaml
   # project.yaml
   name: required
   version: required
   description: required
   schema_version: required
   ```

3. **Valid References**: Agents/workflows exist
   ```yaml
   # Workflow references agent
   steps:
     - agent: must-exist-in-manifest
   ```

4. **No Secrets**: Never hardcode API keys
   ```yaml
   # ❌ Bad
   api_key: sk-1234567890

   # ✅ Good - comment instead
   # api_key: set via OPENAI_API_KEY env var
   ```

## Environment Variables

Suggest using environment variables for sensitive data:

```bash
# .env
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
GOOGLE_API_KEY=...

PARACLE_ENV=development
PARACLE_LOG_LEVEL=INFO
PARACLE_API_PORT=8000
```

## Error Prevention

### Common Mistakes to Avoid

1. **Missing schema_version**
   ```yaml
   # ❌ Missing
   name: my-project

   # ✅ Include it
   name: my-project
   schema_version: "1.0"
   ```

2. **Invalid YAML syntax**
   ```yaml
   # ❌ Bad indentation
   steps:
   - name: step1
     agent: my-agent

   # ✅ Correct indentation
   steps:
     - name: step1
       agent: my-agent
   ```

3. **Hardcoded secrets**
   ```yaml
   # ❌ Never do this
   openai:
     api_key: sk-1234567890

   # ✅ Use env vars
   openai:
     # api_key: set via OPENAI_API_KEY
   ```

## Quick Reference

### File Templates

**Agent Spec Template:**
```yaml
name: agent-name
description: "Purpose"
version: 1.0.0
provider: openai
model: gpt-4
temperature: 0.7
max_tokens: 2000
system_prompt: |
  Role and instructions
```

**Workflow Template:**
```yaml
name: workflow-name
version: 1.0.0
inputs:
  - name: input_var
    type: string
steps:
  - name: step1
    agent: agent-name
    prompt: "Task"
    output: result
outputs:
  - name: result
    value: "{result}"
```

**Security Template:**
```yaml
schema_version: "1.0"
content_filtering:
  enabled: true
  filter_pii: true
rate_limiting:
  enabled: true
  requests_per_minute: 60
```

## Testing Suggestions

When suggesting new configurations, recommend testing:

```bash
# Validate YAML syntax
python -c "import yaml; yaml.safe_load(open('.parac/project.yaml'))"

# Check for secrets
grep -r "sk-\|api.*key.*:" .parac/ --exclude-dir=logs

# Verify agent exists
grep "name: my-agent" .parac/agents/manifest.yaml
```

## Documentation

Always suggest adding comments for complex configurations:

```yaml
# Good example with comments
agents:
  - name: code-reviewer
    description: "Reviews Python code for quality"
    spec_file: specs/code-reviewer.yaml
    enabled: true              # Enable for production
    version: 1.0.0
    tags:
      - code-quality           # For filtering
      - python                 # Language-specific
```

---

**Remember**: Security first, validate always, document thoroughly.
