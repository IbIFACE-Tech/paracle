# Google Gemini Guide for Paracle .parac Configuration

## Introduction

This guide helps Google Gemini AI understand and work with Paracle's `.parac/` configuration system for building multi-agent AI applications.

## What is Paracle?

Paracle is a framework for creating multi-agent AI applications with features like:

- Security and policy management
- Model Context Protocol (MCP) integration

## Configuration Structure

The `.parac/` directory contains all project configuration:

```
.parac/
├── project.yaml              # Main configuration ⭐
├── agents/                   # Agent definitions
│   ├── manifest.yaml        # Agent registry
│   └── specs/*.yaml         # Individual specs
├── workflows/                # Workflow definitions
│   ├── catalog.yaml         # Workflow registry
│   └── templates/*.yaml     # Workflow templates
├── tools/                    # Tool management
│   └── registry.yaml        # Tool permissions
├── policies/                 # Governance
│   ├── policy-pack.yaml     # Active policies
│   └── security.yaml        # Security rules
├── memory/                   # Project knowledge
│   ├── index.yaml           # Memory index
│   └── knowledge/*.md       # Knowledge base
├── adapters/                 # External integrations
│   └── orchestrators.yaml   # Provider configs
└── logs/                     # Runtime logs (auto-generated)
```

## Key Concepts

### 1. Schema Version

All configuration files must include:

```yaml
```

### 2. Project Configuration (project.yaml)

```yaml
name: my-project              # Required: Project identifier
version: 0.1.0               # Required: Semantic version
description: "..."           # Required: Brief description
schema_version: "1.0"        # Required: Schema version

defaults:
  python_version: "3.10"
  model_provider: openai      # openai | anthropic | google | local
  default_model: gpt-4
  temperature: 0.7            # 0.0 (deterministic) to 1.0 (creative)

features:
  enable_mcp: true            # Model Context Protocol
  enable_api: true            # REST API
  enable_events: true         # Event bus
  enable_tracing: false       # OpenTelemetry
```

### 3. Agent Configuration

Agents are defined in two parts:

**Manifest** (agents/manifest.yaml):

schema_version: "1.0"
agents:
    description: "AI assistant"
    spec_file: specs/assistant.yaml
    version: 1.0.0
    tags: [helper, general]

```

**Specification** (agents/specs/assistant.yaml):

```yaml
name: assistant
description: "Helpful AI assistant"
version: 1.0.0

provider: google              # Use Google AI
model: gemini-pro            # Gemini model
temperature: 0.7
max_tokens: 2000

system_prompt: |
  You are a helpful AI assistant.
  Provide clear, accurate, and concise answers.
  When unsure, ask clarifying questions.

# Assign skills to agent
skills:
  - question-answering
  - text-summarization
  - code-generation

capabilities:
  - question_answering
  - task_assistance
  - explanation

tools: []

memory:
  enabled: true
  type: conversation          # conversation | semantic | hybrid
  max_history: 10
```

### Agent Skills

Paracle supports **dual skill formats**:

**YAML Format** (lightweight):
```yaml
# .parac/agents/skills/custom/skill.yaml
name: my-skill
category: creation          # communication|analysis|creation|transformation|integration|memory
level: intermediate         # basic|intermediate|advanced|expert
description: Brief description
tools: [tool1]
capabilities: [cap1, cap2]
```

**SKILL.md Format** (rich documentation with code):
```markdown
# .parac/agents/skills/custom/skill/SKILL.md
---
name: my-skill
description: Detailed description
metadata:
  category: creation
  level: intermediate
allowed-tools: Read Write Bash
---
# My Skill
[Detailed instructions and code examples]
```

**Built-in Skills:**
- `question-answering`, `code-generation`, `data-analysis`, `text-summarization`, `api-integration`

### 4. Workflow Configuration

**Catalog** (workflows/catalog.yaml):

```yaml
schema_version: "1.0"
workflows:
    description: "Generate personalized greeting"
    template: templates/greeting.yaml

    version: 1.0.0
```

**Definition** (workflows/templates/greeting.yaml):

```yaml
name: greeting-workflow
description: "Personalized greeting generation"
version: 1.0.0

inputs:
  - name: user_name
    type: string
    required: true
  - name: language
    type: string
    default: english

steps:
  - name: generate_greeting
    agent: assistant
    prompt: |
      Generate a warm greeting for {user_name} in {language}.
      Make it personal and friendly.
    output: greeting

outputs:
  - name: result
    value: "{greeting}"
```

## Working with Google AI / Gemini

### Model Configuration

```yaml
# For Gemini Pro
provider: google
model: gemini-pro
temperature: 0.7

# For Gemini Pro Vision (multimodal)
provider: google
model: gemini-pro-vision
temperature: 0.8

# In adapters/orchestrators.yaml
model_providers:
  google:
    enabled: true
    type: google
    config:
      # api_key: set via GOOGLE_API_KEY environment variable
      default_model: gemini-pro
      available_models:
        - gemini-pro
        - gemini-pro-vision
```

### Environment Setup

```bash
# Required
export GOOGLE_API_KEY="your-google-api-key"

# Optional Paracle config
export PARACLE_ENV="development"
export PARACLE_LOG_LEVEL="INFO"
```

## Best Practices

### 1. Temperature Settings

```yaml
# Factual tasks (Q&A, data extraction)
temperature: 0.0-0.3

# Balanced tasks (general assistance)
temperature: 0.5-0.7

# Creative tasks (content generation)
temperature: 0.8-1.0
```

### 2. Naming Conventions

```yaml
# ✅ Good
name: data-analyzer          # Descriptive, lowercase-hyphenated
name: content-generator
name: code-reviewer

# ❌ Avoid
name: agent1                 # Not descriptive
name: DataAnalyzer           # Not lowercase
name: data_analyzer          # Use hyphens, not underscores
```

### 3. System Prompts

```yaml
system_prompt: |
  # Start with clear role
  You are a [specific role].

  # Define responsibilities
  Your responsibilities:
  - Task 1
  - Task 2
  - Task 3

  # Set guidelines
  Guidelines:
  - Be concise
  - Provide examples
  - Ask when unclear

  # Add constraints
  Constraints:
  - Stay in scope
  - Verify facts
  - Cite sources when possible
```

### 4. Security Configuration

```yaml
# policies/security.yaml
schema_version: "1.0"

content_filtering:
  enabled: true              # Always enable
  filter_pii: true           # Protect privacy
  filter_harmful: true       # Safety

rate_limiting:
  enabled: true
  requests_per_minute: 60

# tools/registry.yaml
builtin_tools:
  - name: web_search
    enabled: false           # Disabled by default for security

  - name: file_system
    enabled: false
    permissions: [read]      # Minimal permissions
    allowed_paths: [/tmp]    # Restricted paths
```

## Common Tasks

### Initialize New Project

```bash
# Copy template
cp -r templates/.parac-template .parac

# Edit configuration
nano .parac/project.yaml

# Set up environment
cp .parac/.env.example .env
nano .env  # Add GOOGLE_API_KEY
```

### Create New Agent

```bash
# 1. Create specification
cat > .parac/agents/specs/my-agent.yaml << EOF
name: my-agent
provider: google
model: gemini-pro
temperature: 0.7
system_prompt: |
  Your role and instructions...
EOF

# 2. Register in manifest
# Edit .parac/agents/manifest.yaml
agents:
  - name: my-agent
    spec_file: specs/my-agent.yaml
    enabled: true
    version: 1.0.0
```

### Create New Workflow

```bash
# 1. Create template
cat > .parac/workflows/templates/my-workflow.yaml << EOF
name: my-workflow
version: 1.0.0
steps:
  - name: step1
    agent: my-agent
    prompt: "Task description"
    output: result
outputs:
  - name: result
    value: "{result}"
EOF

# 2. Register in catalog
# Edit .parac/workflows/catalog.yaml
workflows:
  - name: my-workflow
    template: templates/my-workflow.yaml
    enabled: true
```

## Validation

### YAML Syntax

```python
import yaml

# Validate syntax
with open('.parac/project.yaml') as f:
    config = yaml.safe_load(f)

# Check schema version
assert config.get('schema_version') == '1.0'

# Check required fields
assert 'name' in config
assert 'version' in config
assert 'description' in config
```

### Security Checks

```bash
# Check for hardcoded secrets
grep -rn "api.?key.*[:=].*['\"]" .parac/ --exclude-dir=logs

# Check for exposed credentials
grep -rn "sk-\|key_.*=.*[a-zA-Z0-9]" .parac/ --exclude-dir=logs

# Verify tools are disabled by default
grep -A5 "builtin_tools:" .parac/tools/registry.yaml | grep "enabled: true" && echo "⚠ Review enabled tools"
```

## Error Handling

### Common Issues

```yaml
# ❌ Error: Missing schema_version
name: my-project

# ✅ Fix: Add schema_version
name: my-project
schema_version: "1.0"

**2. Invalid Agent Reference**

```yaml
# ❌ Error: Agent doesn't exist
steps:

  - agent: non-existent-agent

# ✅ Fix: Use existing agent
steps:
  - agent: assistant  # Defined in manifest
```

**3. Hardcoded Secrets**

```yaml
# ❌ Error: Secret in config
google:
  api_key: "AIza..."

# ✅ Fix: Use environment variable
google:
  # api_key: set via GOOGLE_API_KEY
```

## Advanced Patterns

### Multi-Agent Collaboration

```yaml
# Workflow with multiple agents
name: document-analysis
steps:
  # Agent 1: Extract
  - name: extract
    agent: text-extractor
    prompt: "Extract key info from {document}"
    output: extracted_data

  # Agent 2: Analyze
  - name: analyze
    agent: data-analyzer
    prompt: "Analyze {extracted_data}"
    output: analysis

  # Agent 3: Summarize
  - name: summarize
    agent: summarizer
    prompt: "Summarize {analysis} in 3 bullets"
    output: summary
```

### Agent Inheritance

```yaml
# Base agent
# agents/specs/base-agent.yaml
name: base-agent
provider: google
model: gemini-pro
temperature: 0.7

# Specialized agent
# agents/specs/specialized-agent.yaml
name: specialized-agent
extends: base-agent          # Inherit from base
temperature: 0.9             # Override temperature
system_prompt: |
  Specialized instructions...
```

### Conditional Workflows

```yaml
name: conditional-workflow
steps:
  - name: check
    agent: validator
    prompt: "Validate {input}"
    output: is_valid

  - name: process
    agent: processor
    prompt: "Process {input}"
    output: result
    condition: "{is_valid} == true"  # Only if valid
```

## Tips for Google Gemini

1. **Use Gemini's Strengths**
   - Long context understanding
   - Multimodal capabilities (with gemini-pro-vision)
   - Multilingual support

2. **Temperature Tuning**
   - Start with 0.7 for general tasks
   - Lower to 0.3-0.5 for factual tasks
   - Raise to 0.8-0.9 for creative tasks

3. **System Prompts**
   - Be specific about role and constraints
   - Provide examples when possible
   - Use clear, structured instructions

4. **Token Management**
   - Monitor token usage
   - Set appropriate max_tokens
   - Use streaming for long responses

5. **Error Handling**
   - Configure retries for transient errors
   - Set appropriate timeouts
   - Log errors for debugging

## Quick Reference

### File Templates

```yaml
# Agent
name: agent-name
provider: google
model: gemini-pro
temperature: 0.7
system_prompt: |
  Instructions...

# Workflow
name: workflow-name
steps:
  - name: step1
    agent: agent-name
    prompt: "Task"
    output: result

# Security
content_filtering:
  enabled: true
  filter_pii: true
rate_limiting:
  enabled: true
```

### Environment Variables

```bash
GOOGLE_API_KEY=...           # Required
PARACLE_ENV=development      # Optional
PARACLE_LOG_LEVEL=INFO       # Optional
```

### Validation Commands

```bash
# YAML syntax
python -c "import yaml; yaml.safe_load(open('.parac/project.yaml'))"

# Security check

grep -r "api.*key.*:" .parac/ --exclude-dir=logs

# Agent exists
grep "name: my-agent" .parac/agents/manifest.yaml
```

---

**Remember**:

- Always validate configuration before committing
- Never hardcode API keys
- Enable security features by default
- Document your agents and workflows
- Test incrementally
