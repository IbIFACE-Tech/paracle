# Security Policy for Paracle

version: "1.0"
last_updated: "2025-12-24"

# Security Baseline
baseline:
  level: high
  compliance: [owasp_top_10, cwe_top_25]
  standards: [secure_coding, least_privilege]

# Secret Management
secrets:
  rules:
    - name: no_hardcoded_secrets
      enforcement: blocking
      scan_files: ["*.py", "*.yaml", "*.json", "*.md"]
      exceptions: [".parac/examples/"]

    - name: environment_variables
      enforcement: required
      pattern: "env_var_only"

    - name: secret_rotation
      enforcement: warning
      recommendation: 90_days

  detection:
    - api_keys
    - passwords
    - tokens
    - private_keys
    - connection_strings

  tools:
    - trufflehog
    - detect-secrets
    - git-secrets

# Dependency Security
dependencies:
  rules:
    - name: vulnerability_scan
      enforcement: blocking
      severity_threshold: high
      tools: [safety, pip-audit]
      frequency: weekly

    - name: license_compliance
      enforcement: blocking
      allowed_licenses:
        - Apache-2.0
        - MIT
        - BSD-3-Clause
        - BSD-2-Clause
      forbidden_licenses:
        - GPL-3.0
        - AGPL-3.0

    - name: dependency_pinning
      enforcement: required
      use_lock_file: true

  supply_chain:
    verify_signatures: recommended
    use_private_registry: optional
    sbom_generation: recommended

# Code Security
code:
  rules:
    - name: input_validation
      enforcement: required
      use_pydantic: true

    - name: sql_injection_prevention
      enforcement: blocking
      use_parameterized_queries: true
      orm_required: true

    - name: xss_prevention
      enforcement: blocking
      sanitize_output: true

    - name: csrf_protection
      enforcement: required
      for_apis: true

    - name: authentication_required
      enforcement: required
      exclude_endpoints: ["/health", "/metrics"]

  static_analysis:
    tools: [bandit, semgrep]
    run_on: [commit, pr]

  dynamic_analysis:
    tools: [owasp_zap]
    frequency: weekly
    environment: staging

# Network Security
network:
  rules:
    - name: tls_required
      enforcement: blocking
      min_version: "1.2"

    - name: secure_headers
      enforcement: required
      headers:
        - X-Content-Type-Options
        - X-Frame-Options
        - Strict-Transport-Security
        - Content-Security-Policy

    - name: rate_limiting
      enforcement: required
      default_limit: "100/hour"

    - name: cors_configuration
      enforcement: required
      restrictive_default: true

# Data Security
data:
  rules:
    - name: encryption_at_rest
      enforcement: required
      algorithm: AES-256

    - name: encryption_in_transit
      enforcement: blocking
      use_tls: true

    - name: pii_handling
      enforcement: required
      minimize_collection: true
      anonymization: recommended

    - name: data_retention
      enforcement: required
      default_retention: 365_days
      deletion_process: documented

# Authentication & Authorization
auth:
  rules:
    - name: strong_passwords
      enforcement: required
      min_length: 12
      complexity: high

    - name: mfa_recommended
      enforcement: warning
      for_admin: required

    - name: session_management
      enforcement: required
      timeout: 30_minutes
      secure_cookies: true

    - name: rbac
      enforcement: required
      principle: least_privilege

    - name: api_key_management
      enforcement: required
      rotation: recommended
      scope_limited: true

# Logging & Monitoring
logging:
  rules:
    - name: security_events_logged
      enforcement: required
      events:
        - authentication_attempts
        - authorization_failures
        - data_access
        - configuration_changes

    - name: no_sensitive_data_in_logs
      enforcement: blocking
      redact:
        - passwords
        - tokens
        - api_keys
        - pii

    - name: log_retention
      enforcement: required
      duration: 90_days

    - name: audit_trail
      enforcement: required
      immutable: true

# Incident Response
incident_response:
  process_documented: true
  contact: security@ibiface-tech.com

  severity_levels:
    critical:
      response_time: 1_hour
      escalation: immediate

    high:
      response_time: 4_hours
      escalation: same_day

    medium:
      response_time: 24_hours
      escalation: 3_days

    low:
      response_time: 7_days
      escalation: 14_days

  reporting:
    internal: required
    external: as_per_regulations
    disclosure: responsible

# Security Testing
testing:
  types:
    - unit_tests_for_security
    - integration_security_tests
    - penetration_testing
    - security_code_review

  frequency:
    unit_tests: every_commit
    integration_tests: every_pr
    penetration_testing: quarterly
    code_review: every_pr

  tools:
    - pytest_security
    - safety
    - bandit
    - owasp_zap

# Compliance
compliance:
  frameworks:
    - owasp_top_10
    - cwe_top_25

  privacy:
    gdpr_aware: true
    data_minimization: required

  reporting:
    security_metrics: monthly
    vulnerability_reports: as_discovered

# Security Training
training:
  required: true
  frequency: annually
  topics:
    - secure_coding
    - common_vulnerabilities
    - incident_response
    - privacy_best_practices

# Responsible Disclosure
responsible_disclosure:
  enabled: true
  email: security@ibiface-tech.com
  acknowledgment: public
  reward_program: future_consideration
